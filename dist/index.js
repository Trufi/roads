/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={8518:function(e,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.applyDefaults=void 0,t.applyDefaults=function(e,t){var n=r({},t);for(var i in e)void 0!==e[i]&&(n[i]=e[i]);return n}},9753:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=void 0,t.clamp=function(e,t,r){return e=Math.max(e,t),Math.min(e,r)}},7134:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0;var r=function(){function e(){this.events={}}return e.prototype.on=function(e,t){var r=this.events[e];return r||(r=this.events[e]=[]),r.push(t),this},e.prototype.once=function(e,t){var r=this,n=function(i){r.off(e,n),t.call(r,i)};return this.on(e,n),this},e.prototype.off=function(e,t){var r=this.events[e];if(!r)return this;var n=r.indexOf(t);return-1!==n&&r.splice(n,1),this},e.prototype.emit=function(e,t){var r=this.events[e];if(!r)return this;for(var n=r.slice(),i=0;i<n.length;i++)n[i].call(this,t);return this},e}();t.EventEmitter=r},1380:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nearestPointOnSegment=void 0,t.nearestPointOnSegment=function(e,t,r){var n=e[0]-t[0],i=e[1]-t[1],o=r[0]-t[0],a=r[1]-t[1],u=o*o+a*a,c=0!==u?(n*o+i*a)/u:0;return c<0?{point:t,t:0}:c>1?{point:r,t:1}:{point:[Math.round(t[0]+c*o),Math.round(t[1]+c*a)],t:c}}},740:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayShuffle=t.arrayInsert=void 0;var n=r(950);Object.defineProperty(t,"arrayInsert",{enumerable:!0,get:function(){return n.arrayInsert}});var i=r(9046);Object.defineProperty(t,"arrayShuffle",{enumerable:!0,get:function(){return i.arrayShuffle}})},950:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayInsert=void 0,t.arrayInsert=function(e,t,r){var n=e.slice(0,t),i=e.slice(t);return n.push(r),n.concat(i)}},9046:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayShuffle=void 0,t.arrayShuffle=function(e,t){void 0===t&&(t=Math.random);for(var r=e.slice(),n=0;n<r.length;n++){var i=n+Math.floor(t()*(r.length-n)),o=r[n];r[n]=r[i],r[i]=o}return r}},1535:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.affineStep=void 0;var n=r(9935);t.affineStep=function(e,t,r){return n.clamp((r-e)/(t-e),0,1)}},590:function(e,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.applyDefaults=void 0,t.applyDefaults=function(e,t){var n=r({},t);for(var i in e)void 0!==e[i]&&(n[i]=e[i]);return n}},7279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.circleIcon=void 0,t.circleIcon=function(e,t,r,n){return void 0===r&&(r="#000"),void 0===n&&(n=0),"data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="'+2*t+'" height="'+2*t+'" viewBox="0 0 '+2*t+" "+2*t+'">\n        <circle fill="'+e+'" cx="'+t+'" cy="'+t+'" r="'+t+'"/>\n        <circle fill="'+r+'" cx="'+t+'" cy="'+t+'" r="'+n+'"/>\n    </svg>')}},9935:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=void 0,t.clamp=function(e,t,r){return e=Math.max(e,t),Math.min(e,r)}},7996:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.degToRad=void 0,t.degToRad=function(e){return e*Math.PI/180}},4474:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0;var r=function(){function e(){this.events={}}return e.prototype.on=function(e,t){var r=this.events[e];return r||(r=this.events[e]=[]),r.push(t),this},e.prototype.once=function(e,t){var r=this,n=function(i){r.off(e,n),t.call(r,i)};return this.on(e,n),this},e.prototype.off=function(e,t){var r=this.events[e];if(!r)return this;var n=r.indexOf(t);return-1!==n&&r.splice(n,1),this},e.prototype.emit=function(e,t){var r=this.events[e];if(!r)return this;for(var n=r.slice(),i=0;i<n.length;i++)n[i].call(this,t);return this},e}();t.EventEmitter=r},9875:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.sign=t.round=t.radToDeg=t.pick=t.nearestPointOnSegment=t.EventEmitter=t.degToRad=t.clamp=t.circleIcon=t.applyDefaults=t.affineStep=void 0;var n=r(1535);Object.defineProperty(t,"affineStep",{enumerable:!0,get:function(){return n.affineStep}});var i=r(590);Object.defineProperty(t,"applyDefaults",{enumerable:!0,get:function(){return i.applyDefaults}});var o=r(7279);Object.defineProperty(t,"circleIcon",{enumerable:!0,get:function(){return o.circleIcon}});var a=r(9935);Object.defineProperty(t,"clamp",{enumerable:!0,get:function(){return a.clamp}});var u=r(7996);Object.defineProperty(t,"degToRad",{enumerable:!0,get:function(){return u.degToRad}});var c=r(4474);Object.defineProperty(t,"EventEmitter",{enumerable:!0,get:function(){return c.EventEmitter}});var s=r(1883);Object.defineProperty(t,"nearestPointOnSegment",{enumerable:!0,get:function(){return s.nearestPointOnSegment}});var d=r(1758);Object.defineProperty(t,"pick",{enumerable:!0,get:function(){return d.pick}});var f=r(7461);Object.defineProperty(t,"radToDeg",{enumerable:!0,get:function(){return f.radToDeg}});var l=r(1152);Object.defineProperty(t,"round",{enumerable:!0,get:function(){return l.round}});var v=r(4290);Object.defineProperty(t,"sign",{enumerable:!0,get:function(){return v.sign}});var p=r(1702);Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return p.throttle}})},1883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nearestPointOnSegment=void 0,t.nearestPointOnSegment=function(e,t,r){var n=e[0]-t[0],i=e[1]-t[1],o=r[0]-t[0],a=r[1]-t[1],u=o*o+a*a,c=0!==u?(n*o+i*a)/u:0;return c<0?{point:t,t:0}:c>1?{point:r,t:1}:{point:[Math.round(t[0]+c*o),Math.round(t[1]+c*a)],t:c}}},1758:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pick=void 0,t.pick=function(e,t){for(var r={},n=0;n<t.length;n++)r[t[n]]=e[t[n]];return r}},7461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.radToDeg=void 0,t.radToDeg=function(e){return e/Math.PI*180}},1152:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.round=void 0,t.round=function(e,t){void 0===t&&(t=0);var r=Math.pow(10,t);return Math.round(e*r)/r}},4290:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sign=void 0,t.sign=function(e){return 0==(e=+e)||Number.isNaN(e)?e:e>0?1:-1}},1702:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=void 0,t.throttle=function(e,t,r){var n,i=!1;function o(){i=!1,n&&(a.apply(r,n),n=void 0)}function a(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];i?n=a:(e.apply(r,a),setTimeout(o,t),i=!0)}return a}},5545:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coordinatesPrecision=void 0,t.coordinatesPrecision=function(e){return Math.ceil((e*Math.LN2+Math.log(256/360/.5))/Math.LN10)}},4001:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geoDistance=void 0,t.geoDistance=function(e,t){var r=Math.PI/180,n=e[1]*r,i=t[1]*r,o=Math.sin((t[1]-e[1])*r/2),a=Math.sin((t[0]-e[0])*r/2),u=o*o+Math.cos(n)*Math.cos(i)*a*a,c=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return Math.round(6371e3*c)}},943:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coordinatesPrecision=t.geoDistance=void 0;var n=r(4001);Object.defineProperty(t,"geoDistance",{enumerable:!0,get:function(){return n.geoDistance}});var i=r(5545);Object.defineProperty(t,"coordinatesPrecision",{enumerable:!0,get:function(){return i.coordinatesPrecision}})},7723:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(740),t),i(r(9875),t),i(r(943),t),i(r(3367),t),i(r(8999),t),i(r(4060),t),i(r(5610),t),i(r(7495),t),i(r(2083),t),i(r(8123),t)},1775:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapFind=void 0,t.mapFind=function(e,t){for(var r=e.entries(),n=r.next();!n.done;){var i=n.value,o=i[0],a=i[1];if(t(a,o))return a;n=r.next()}}},3367:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapMap=t.mapFind=void 0;var n=r(1775);Object.defineProperty(t,"mapFind",{enumerable:!0,get:function(){return n.mapFind}});var i=r(5340);Object.defineProperty(t,"mapMap",{enumerable:!0,get:function(){return i.mapMap}})},5340:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapMap=void 0,t.mapMap=function(e,t){var r=[];return e.forEach((function(e,n){return r.push(t(e,n))})),r}},3131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worldSize=void 0,t.worldSize=Math.pow(2,32)},8523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapPointFromLngLat=void 0;var n=r(3131),i=r(9935),o=r(7996);t.mapPointFromLngLat=function(e){var t=Math.sin(o.degToRad(e[1])),r=e[0]*n.worldSize/360,a=Math.log((1+t)/(1-t))*n.worldSize/(4*Math.PI),u=n.worldSize/2;return[i.clamp(r,-u,u),i.clamp(a,-u,u)]}},8999:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapPointToLngLat=t.mapPointFromLngLat=void 0;var n=r(8523);Object.defineProperty(t,"mapPointFromLngLat",{enumerable:!0,get:function(){return n.mapPointFromLngLat}});var i=r(4175);Object.defineProperty(t,"mapPointToLngLat",{enumerable:!0,get:function(){return i.mapPointToLngLat}})},4175:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapPointToLngLat=void 0;var n=r(3131),i=r(7461);t.mapPointToLngLat=function(e){var t=-2*Math.PI/n.worldSize;return[360*e[0]/n.worldSize,90-2*i.radToDeg(Math.atan(Math.exp(e[1]*t)))]}},9645:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRandomFunction=void 0,t.createRandomFunction=function(e){return function(){return((e=16807*e%2147483647)-1)/2147483646}}},4060:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomSeed=t.createRandomFunction=void 0;var n=r(9645);Object.defineProperty(t,"createRandomFunction",{enumerable:!0,get:function(){return n.createRandomFunction}});var i=r(9597);Object.defineProperty(t,"randomSeed",{enumerable:!0,get:function(){return i.randomSeed}})},9597:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomSeed=void 0,t.randomSeed=function(){return Math.round(2147483647*Math.random())}},5610:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.percentile=t.p90=t.p75=t.p25=t.median=void 0;var n=r(3645);Object.defineProperty(t,"median",{enumerable:!0,get:function(){return n.median}});var i=r(4523);Object.defineProperty(t,"p25",{enumerable:!0,get:function(){return i.p25}});var o=r(9241);Object.defineProperty(t,"p75",{enumerable:!0,get:function(){return o.p75}});var a=r(699);Object.defineProperty(t,"p90",{enumerable:!0,get:function(){return a.p90}});var u=r(193);Object.defineProperty(t,"percentile",{enumerable:!0,get:function(){return u.percentile}})},3645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.median=void 0;var n=r(193);t.median=function(e){return n.percentile(e,.5)}},4523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p25=void 0;var n=r(193);t.p25=function(e){return n.percentile(e,.25)}},9241:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p75=void 0;var n=r(193);t.p75=function(e){return n.percentile(e,.75)}},699:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p90=void 0;var n=r(193);t.p90=function(e){return n.percentile(e,.9)}},193:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.percentile=void 0,t.percentile=function(e,t){var r=e.slice();return r.sort((function(e,t){return e-t})),r[Math.floor(r.length*t)]}},7775:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2angle=void 0,t.vec2angle=function(e){return Math.atan2(e[1],e[0])}},4853:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2copy=void 0,t.vec2copy=function(e,t){e[0]=t[0],e[1]=t[1]}},4852:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2create=void 0,t.vec2create=function(){return[0,0]}},1624:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2cross=void 0,t.vec2cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];e[0]=e[1]=0,e[2]=n}},495:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2dist=void 0,t.vec2dist=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}},7428:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2dot=void 0,t.vec2dot=function(e,t){return e[0]*t[0]+e[1]*t[1]}},6998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2equals=void 0,t.vec2equals=function(e,t,r){return void 0===r&&(r=1e-6),Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r}},506:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2exactEquals=void 0,t.vec2exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]}},7495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2set=t.vec2rotate=t.vec2normalize=t.vec2max=t.vec2min=t.vec2lerp=t.vec2length=t.vec2exactEquals=t.vec2equals=t.vec2dot=t.vec2dist=t.vec2cross=t.vec2create=t.vec2copy=t.vec2angle=void 0;var n=r(7775);Object.defineProperty(t,"vec2angle",{enumerable:!0,get:function(){return n.vec2angle}});var i=r(4853);Object.defineProperty(t,"vec2copy",{enumerable:!0,get:function(){return i.vec2copy}});var o=r(4852);Object.defineProperty(t,"vec2create",{enumerable:!0,get:function(){return o.vec2create}});var a=r(1624);Object.defineProperty(t,"vec2cross",{enumerable:!0,get:function(){return a.vec2cross}});var u=r(495);Object.defineProperty(t,"vec2dist",{enumerable:!0,get:function(){return u.vec2dist}});var c=r(7428);Object.defineProperty(t,"vec2dot",{enumerable:!0,get:function(){return c.vec2dot}});var s=r(6998);Object.defineProperty(t,"vec2equals",{enumerable:!0,get:function(){return s.vec2equals}});var d=r(506);Object.defineProperty(t,"vec2exactEquals",{enumerable:!0,get:function(){return d.vec2exactEquals}});var f=r(581);Object.defineProperty(t,"vec2length",{enumerable:!0,get:function(){return f.vec2length}});var l=r(2862);Object.defineProperty(t,"vec2lerp",{enumerable:!0,get:function(){return l.vec2lerp}});var v=r(2608);Object.defineProperty(t,"vec2min",{enumerable:!0,get:function(){return v.vec2min}});var p=r(2090);Object.defineProperty(t,"vec2max",{enumerable:!0,get:function(){return p.vec2max}});var h=r(5873);Object.defineProperty(t,"vec2normalize",{enumerable:!0,get:function(){return h.vec2normalize}});var g=r(2020);Object.defineProperty(t,"vec2rotate",{enumerable:!0,get:function(){return g.vec2rotate}});var m=r(3883);Object.defineProperty(t,"vec2set",{enumerable:!0,get:function(){return m.vec2set}})},581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2length=void 0,t.vec2length=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}},2862:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2lerp=void 0,t.vec2lerp=function(e,t,r,n){var i=t[0],o=t[1];e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o)}},2090:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2max=void 0,t.vec2max=function(e,t,r){e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1])}},2608:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2min=void 0,t.vec2min=function(e,t,r){e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1])}},5873:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2normalize=void 0,t.vec2normalize=function(e,t){var r=t[0],n=t[1],i=r*r+n*n;i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i)}},2020:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2rotate=void 0,t.vec2rotate=function(e,t,r){var n=t[0],i=t[1];e[0]=n*Math.cos(r)+i*Math.sin(r),e[1]=-n*Math.sin(r)+i*Math.cos(r)}},3883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2set=void 0,t.vec2set=function(e,t,r){e[0]=t,e[1]=r}},6666:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3copy=void 0,t.vec3copy=function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2]}},8164:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3create=void 0,t.vec3create=function(){return[0,0,0]}},7648:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3dist=void 0,t.vec3dist=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}},3440:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3equals=void 0,t.vec3equals=function(e,t,r){return void 0===r&&(r=1e-6),Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r}},8876:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3exactEquals=void 0,t.vec3exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},2083:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3set=t.vec3normalize=t.vec3max=t.vec3min=t.vec3lerp=t.vec3exactEquals=t.vec3equals=t.vec3dist=t.vec3create=t.vec3copy=void 0;var n=r(6666);Object.defineProperty(t,"vec3copy",{enumerable:!0,get:function(){return n.vec3copy}});var i=r(8164);Object.defineProperty(t,"vec3create",{enumerable:!0,get:function(){return i.vec3create}});var o=r(7648);Object.defineProperty(t,"vec3dist",{enumerable:!0,get:function(){return o.vec3dist}});var a=r(3440);Object.defineProperty(t,"vec3equals",{enumerable:!0,get:function(){return a.vec3equals}});var u=r(8876);Object.defineProperty(t,"vec3exactEquals",{enumerable:!0,get:function(){return u.vec3exactEquals}});var c=r(4034);Object.defineProperty(t,"vec3lerp",{enumerable:!0,get:function(){return c.vec3lerp}});var s=r(5348);Object.defineProperty(t,"vec3min",{enumerable:!0,get:function(){return s.vec3min}});var d=r(8430);Object.defineProperty(t,"vec3max",{enumerable:!0,get:function(){return d.vec3max}});var f=r(342);Object.defineProperty(t,"vec3normalize",{enumerable:!0,get:function(){return f.vec3normalize}});var l=r(1245);Object.defineProperty(t,"vec3set",{enumerable:!0,get:function(){return l.vec3set}})},4034:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3lerp=void 0,t.vec3lerp=function(e,t,r,n){var i=t[0],o=t[1],a=t[2];e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a)}},8430:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3max=void 0,t.vec3max=function(e,t,r){e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2])}},5348:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3min=void 0,t.vec3min=function(e,t,r){e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2])}},342:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3normalize=void 0,t.vec3normalize=function(e,t){var r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o)}},1245:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3set=void 0,t.vec3set=function(e,t,r,n){e[0]=t,e[1]=r,e[2]=n}},331:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4copy=void 0,t.vec4copy=function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]}},59:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4create=void 0,t.vec4create=function(){return[0,0,0,0]}},8025:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4dist=void 0,t.vec4dist=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+o*o)}},6106:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4equals=void 0,t.vec4equals=function(e,t,r){return void 0===r&&(r=1e-6),Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r}},7122:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4exactEquals=void 0,t.vec4exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}},8123:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4set=t.vec4normalize=t.vec4max=t.vec4min=t.vec4lerp=t.vec4exactEquals=t.vec4equals=t.vec4dist=t.vec4create=t.vec4copy=void 0;var n=r(331);Object.defineProperty(t,"vec4copy",{enumerable:!0,get:function(){return n.vec4copy}});var i=r(59);Object.defineProperty(t,"vec4create",{enumerable:!0,get:function(){return i.vec4create}});var o=r(8025);Object.defineProperty(t,"vec4dist",{enumerable:!0,get:function(){return o.vec4dist}});var a=r(6106);Object.defineProperty(t,"vec4equals",{enumerable:!0,get:function(){return a.vec4equals}});var u=r(7122);Object.defineProperty(t,"vec4exactEquals",{enumerable:!0,get:function(){return u.vec4exactEquals}});var c=r(356);Object.defineProperty(t,"vec4lerp",{enumerable:!0,get:function(){return c.vec4lerp}});var s=r(2071);Object.defineProperty(t,"vec4min",{enumerable:!0,get:function(){return s.vec4min}});var d=r(868);Object.defineProperty(t,"vec4max",{enumerable:!0,get:function(){return d.vec4max}});var f=r(8883);Object.defineProperty(t,"vec4normalize",{enumerable:!0,get:function(){return f.vec4normalize}});var l=r(7040);Object.defineProperty(t,"vec4set",{enumerable:!0,get:function(){return l.vec4set}})},356:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4lerp=void 0,t.vec4lerp=function(e,t,r,n){var i=t[0],o=t[1],a=t[2],u=t[3];e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e[3]=u+n*(r[3]-u)}},868:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4max=void 0,t.vec4max=function(e,t,r){e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3])}},2071:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4min=void 0,t.vec4min=function(e,t,r){e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3])}},8883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4normalize=void 0,t.vec4normalize=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a)}},7040:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4set=void 0,t.vec4set=function(e,t,r,n,i){e[0]=t,e[1]=r,e[2]=n,e[3]=i}},691:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2dist=void 0,t.vec2dist=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}},457:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2lerp=void 0,t.vec2lerp=function(e,t,r,n){var i=t[0],o=t[1];e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o)}},2582:function(e){e.exports=function(){"use strict";function e(e,n,i,o,a){!function e(r,n,i,o,a){for(;o>i;){if(o-i>600){var u=o-i+1,c=n-i+1,s=Math.log(u),d=.5*Math.exp(2*s/3),f=.5*Math.sqrt(s*d*(u-d)/u)*(c-u/2<0?-1:1);e(r,n,Math.max(i,Math.floor(n-c*d/u+f)),Math.min(o,Math.floor(n+(u-c)*d/u+f)),a)}var l=r[n],v=i,p=o;for(t(r,i,n),a(r[o],l)>0&&t(r,i,o);v<p;){for(t(r,v,p),v++,p--;a(r[v],l)<0;)v++;for(;a(r[p],l)>0;)p--}0===a(r[i],l)?t(r,i,p):t(r,++p,o),p<=n&&(i=p+1),n<=p&&(o=p-1)}}(e,n,i||0,o||e.length-1,a||r)}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function o(e,t){a(e,0,e.children.length,t,e)}function a(e,t,r,n,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o=t;o<r;o++){var a=e.children[o];u(i,e.leaf?n(a):a)}return i}function u(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function c(e,t){return e.minX-t.minX}function s(e,t){return e.minY-t.minY}function d(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function l(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function v(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function p(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function h(t,r,n,i,o){for(var a=[r,n];a.length;)if(!((n=a.pop())-(r=a.pop())<=i)){var u=r+Math.ceil((n-r)/i/2)*i;e(t,u,r,n,o),a.push(r,u,u,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(e){var t=this.data,r=[];if(!v(e,t))return r;for(var n=this.toBBox,i=[];t;){for(var o=0;o<t.children.length;o++){var a=t.children[o],u=t.leaf?n(a):a;v(e,u)&&(t.leaf?r.push(a):l(e,u)?this._all(a,r):i.push(a))}t=i.pop()}return r},n.prototype.collides=function(e){var t=this.data;if(!v(e,t))return!1;for(var r=[];t;){for(var n=0;n<t.children.length;n++){var i=t.children[n],o=t.leaf?this.toBBox(i):i;if(v(e,o)){if(t.leaf||l(e,o))return!0;r.push(i)}}t=r.pop()}return!1},n.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},n.prototype.clear=function(){return this.data=p([]),this},n.prototype.remove=function(e,t){if(!e)return this;for(var r,n,o,a=this.data,u=this.toBBox(e),c=[],s=[];a||c.length;){if(a||(a=c.pop(),n=c[c.length-1],r=s.pop(),o=!0),a.leaf){var d=i(e,a.children,t);if(-1!==d)return a.children.splice(d,1),c.push(a),this._condense(c),this}o||a.leaf||!l(a,u)?n?(r++,a=n.children[r],o=!1):a=null:(c.push(a),s.push(r),r=0,n=a,a=a.children[0])}return this},n.prototype.toBBox=function(e){return e},n.prototype.compareMinX=function(e,t){return e.minX-t.minX},n.prototype.compareMinY=function(e,t){return e.minY-t.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(e){return this.data=e,this},n.prototype._all=function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},n.prototype._build=function(e,t,r,n){var i,a=r-t+1,u=this._maxEntries;if(a<=u)return o(i=p(e.slice(t,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,n-1))),(i=p([])).leaf=!1,i.height=n;var c=Math.ceil(a/u),s=c*Math.ceil(Math.sqrt(u));h(e,t,r,s,this.compareMinX);for(var d=t;d<=r;d+=s){var f=Math.min(d+s-1,r);h(e,d,f,c,this.compareMinY);for(var l=d;l<=f;l+=c){var v=Math.min(l+c-1,f);i.children.push(this._build(e,l,v,n-1))}}return o(i,this.toBBox),i},n.prototype._chooseSubtree=function(e,t,r,n){for(;n.push(t),!t.leaf&&n.length-1!==r;){for(var i=1/0,o=1/0,a=void 0,u=0;u<t.children.length;u++){var c=t.children[u],s=d(c),f=(l=e,v=c,(Math.max(v.maxX,l.maxX)-Math.min(v.minX,l.minX))*(Math.max(v.maxY,l.maxY)-Math.min(v.minY,l.minY))-s);f<o?(o=f,i=s<i?s:i,a=c):f===o&&s<i&&(i=s,a=c)}t=a||t.children[0]}var l,v;return t},n.prototype._insert=function(e,t,r){var n=r?e:this.toBBox(e),i=[],o=this._chooseSubtree(n,this.data,t,i);for(o.children.push(e),u(o,n);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(n,i,t)},n.prototype._split=function(e,t){var r=e[t],n=r.children.length,i=this._minEntries;this._chooseSplitAxis(r,i,n);var a=this._chooseSplitIndex(r,i,n),u=p(r.children.splice(a,r.children.length-a));u.height=r.height,u.leaf=r.leaf,o(r,this.toBBox),o(u,this.toBBox),t?e[t-1].children.push(u):this._splitRoot(r,u)},n.prototype._splitRoot=function(e,t){this.data=p([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(e,t,r){for(var n,i,o,u,c,s,f,l=1/0,v=1/0,p=t;p<=r-t;p++){var h=a(e,0,p,this.toBBox),g=a(e,p,r,this.toBBox),m=(i=h,o=g,void 0,void 0,void 0,void 0,u=Math.max(i.minX,o.minX),c=Math.max(i.minY,o.minY),s=Math.min(i.maxX,o.maxX),f=Math.min(i.maxY,o.maxY),Math.max(0,s-u)*Math.max(0,f-c)),y=d(h)+d(g);m<l?(l=m,n=p,v=y<v?y:v):m===l&&y<v&&(v=y,n=p)}return n||r-t},n.prototype._chooseSplitAxis=function(e,t,r){var n=e.leaf?this.compareMinX:c,i=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,i)&&e.children.sort(n)},n.prototype._allDistMargin=function(e,t,r,n){e.children.sort(n);for(var i=this.toBBox,o=a(e,0,t,i),c=a(e,r-t,r,i),s=f(o)+f(c),d=t;d<r-t;d++){var l=e.children[d];u(o,e.leaf?i(l):l),s+=f(o)}for(var v=r-t-1;v>=t;v--){var p=e.children[v];u(c,e.leaf?i(p):p),s+=f(c)}return s},n.prototype._adjustParentBBoxes=function(e,t,r){for(var n=r;n>=0;n--)u(t[n],e)},n.prototype._condense=function(e){for(var t=e.length-1,r=void 0;t>=0;t--)0===e[t].children.length?t>0?(r=e[t-1].children).splice(r.indexOf(e[t]),1):this.clear():o(e[t],this.toBBox)},n}()},6009:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prepareGraph=void 0;var n=r(691);r(4087);var i=r(1200);t.prepareGraph=function(e){var t;i.unpackGraph(e);var r=e;return e.vertices.forEach((function(e,t){var n,i=e;i.index=t,i.edges=e.edges.map((function(e){return r.edges[e]})),i.pathFind={f:0,g:0,id:-1,routeLength:0,parent:void 0},i.userData=null!==(n=e.userData)&&void 0!==n?n:{}})),e.edges.forEach((function(e,t){var i,o=e;o.index=t,o.a=r.vertices[e.a],o.b=r.vertices[e.b],o.length=function(e){for(var t=0,r=1;r<e.length;r++)t+=n.vec2dist(e[r-1],e[r]);return t}(o.geometry),o.userData=null!==(i=e.userData)&&void 0!==i?i:{}})),r.userData=null!==(t=e.userData)&&void 0!==t?t:{},r}},4087:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1200:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unpackGraph=void 0,r(4087);var n=100;t.unpackGraph=function(e){1!==e.formatVersion&&console.warn("Supported format version is only 1, but data graph format version is "+e.formatVersion);var t=0,r=0;function i(e){t=e[0]=e[0]+t,r=e[1]=e[1]+r}var o=0;function a(e){return o=e+o}e.vertices.forEach((function(t){i(t.coords),t.coords[0]=t.coords[0]*n,t.coords[1]=t.coords[1]*n,t.coords[0]=t.coords[0]+e.center[0],t.coords[1]=t.coords[1]+e.center[1],t.edges=t.edges.map(a)})),e.edges.forEach((function(t){t.a=a(t.a),t.b=a(t.b),void 0===t.geometry?t.geometry=[e.vertices[t.a].coords,e.vertices[t.b].coords]:t.geometry.forEach((function(t){i(t),t[0]=t[0]*n,t[1]=t[1]*n,t[0]=t[0]+e.center[0],t[1]=t[1]+e.center[1]}))}))}},1460:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAtFromSegment=t.getSegment=t.findEdgeFromVertexToVertex=void 0;var n=r(9753),i=r(691),o=r(457);r(4087),t.findEdgeFromVertexToVertex=function(e,t){for(var r=0,n=e.edges;r<n.length;r++){var i=n[r];if(i.a===e&&i.b===t)return{edge:i,forward:!0};if(i.a===t&&i.b===e)return{edge:i,forward:!1}}},t.getSegment=function(e,t){for(var r=e.length,a=e.geometry,u=r*t,c=0,s=0;s<a.length-1;s++){var d=i.vec2dist(a[s],a[s+1]);if(c+d>=u){var f=[0,0],l=d>0?n.clamp((u-c)/d,0,1):0;return o.vec2lerp(f,a[s],a[s+1],l),{segmentIndex:s,positionAtSegment:l,coords:f}}c+=d}return{segmentIndex:0,positionAtSegment:0,coords:[0,0]}},t.getAtFromSegment=function(e,t,r){for(var n=e.length,o=e.geometry,a=0,u=0;u<r;u++)a+=i.vec2dist(o[u],o[u+1]);return(a+=i.vec2dist(o[r],o[r+1])*t)/n}},5502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VertexFinder=void 0;var n=r(655),i=r(1380),o=r(691),a=n.__importDefault(r(2582));r(4087);var u=r(1460),c=function(){function e(e){this.graph=e,this.tree=new a.default,this.tree.load(this.graph.vertices.map((function(e){return function(e,t){return{minX:e[0],minY:e[1],maxX:e[0],maxY:e[1],vertex:t}}(e.coords,e)})))}return e.prototype.findVertices=function(e,t){return this.tree.search(s(e,t)).map((function(e){return e.vertex}))},e.prototype.findNearest=function(e,t){var r=this;void 0===t&&(t=1/0);for(var n,a=this.tree.search(s(e,131072)).map((function(e){return e.vertex})),c=new Set,d=0,f=a;d<f.length;d++)for(var l=0,v=f[d].edges;l<v.length;l++){var p=v[l];c.add(p.index)}if(c.forEach((function(a){for(var u=r.graph.edges[a],c=0;c<u.geometry.length-1;c++){var s=i.nearestPointOnSegment(e,u.geometry[c],u.geometry[c+1]),d=o.vec2dist(e,s.point);d<t&&(t=d,n={edge:u,segmentIndex:c,positionAtSegment:s.t,coords:s.point})}})),n)return{edge:n.edge,segmentIndex:n.segmentIndex,positionAtSegment:n.positionAtSegment,coords:n.coords,at:u.getAtFromSegment(n.edge,n.positionAtSegment,n.segmentIndex)}},e}();function s(e,t){return{minX:e[0]-t,minY:e[1]-t,maxX:e[0]+t,maxY:e[1]+t}}t.VertexFinder=c},4432:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PathfindHeuristicFunction=t.breadthFirstTraversalFromMidway=t.getRouteGeometry=t.Route=t.PointMoveEvent=t.PointEvents=t.Point=t.PointPosition=t.PointInitialData=t.DataGraphVertex=t.DataGraphEdge=t.DataGraph=t.ClientGraphVertex=t.ClientGraphEdge=t.ClientGraph=t.RoadsOptions=t.RoadsEvents=t.Roads=void 0;var n=r(6074);Object.defineProperty(t,"Roads",{enumerable:!0,get:function(){return n.Roads}}),Object.defineProperty(t,"RoadsEvents",{enumerable:!0,get:function(){return n.RoadsEvents}}),Object.defineProperty(t,"RoadsOptions",{enumerable:!0,get:function(){return n.RoadsOptions}});var i=r(4087);Object.defineProperty(t,"ClientGraph",{enumerable:!0,get:function(){return i.ClientGraph}}),Object.defineProperty(t,"ClientGraphEdge",{enumerable:!0,get:function(){return i.ClientGraphEdge}}),Object.defineProperty(t,"ClientGraphVertex",{enumerable:!0,get:function(){return i.ClientGraphVertex}}),Object.defineProperty(t,"DataGraph",{enumerable:!0,get:function(){return i.DataGraph}}),Object.defineProperty(t,"DataGraphEdge",{enumerable:!0,get:function(){return i.DataGraphEdge}}),Object.defineProperty(t,"DataGraphVertex",{enumerable:!0,get:function(){return i.DataGraphVertex}});var o=r(9294);Object.defineProperty(t,"PointInitialData",{enumerable:!0,get:function(){return o.PointInitialData}}),Object.defineProperty(t,"PointPosition",{enumerable:!0,get:function(){return o.PointPosition}}),Object.defineProperty(t,"Point",{enumerable:!0,get:function(){return o.Point}}),Object.defineProperty(t,"PointEvents",{enumerable:!0,get:function(){return o.PointEvents}}),Object.defineProperty(t,"PointMoveEvent",{enumerable:!0,get:function(){return o.PointMoveEvent}});var a=r(7558);Object.defineProperty(t,"Route",{enumerable:!0,get:function(){return a.Route}}),Object.defineProperty(t,"getRouteGeometry",{enumerable:!0,get:function(){return a.getRouteGeometry}});var u=r(4603);Object.defineProperty(t,"breadthFirstTraversalFromMidway",{enumerable:!0,get:function(){return u.breadthFirstTraversalFromMidway}}),Object.defineProperty(t,"PathfindHeuristicFunction",{enumerable:!0,get:function(){return u.PathfindHeuristicFunction}})},225:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlatQueue=void 0;var r=function(){function e(){this.ids=[],this.values=[],this.length=0}return e.prototype.clear=function(){this.length=0},e.prototype.push=function(e,t){var r=this.length++;for(this.ids[r]=e,this.values[r]=t;r>0;){var n=r-1>>1,i=this.values[n];if(t>=i)break;this.ids[r]=this.ids[n],this.values[r]=i,r=n}this.ids[r]=e,this.values[r]=t},e.prototype.pop=function(){if(0!==this.length){var e=this.ids[0];if(this.length--,this.length>0){for(var t=this.ids[0]=this.ids[this.length],r=this.values[0]=this.values[this.length],n=this.length>>1,i=0;i<n;){var o=1+(i<<1),a=o+1,u=this.ids[o],c=this.values[o],s=this.values[a];if(a<this.length&&s<c&&(o=a,u=this.ids[a],c=s),c>=r)break;this.ids[i]=u,this.values[i]=c,i=o}this.ids[i]=t,this.values[i]=r}return e}},e.prototype.peek=function(){return this.ids[0]},e.prototype.peekValue=function(){return this.values[0]},e}();t.FlatQueue=r},4603:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breadthFirstTraversalFromMidway=t.pathfindFromMidway=void 0,r(4087);var n=r(1460);r(9294),r(7558);var i=r(225),o=r(4842),a=new i.FlatQueue,u=0;t.pathfindFromMidway=function(e,t,r){if(e.edge===t.edge)return{fromAt:e.at,toAt:t.at,edges:[{edge:e.edge,forward:e.at<t.at}]};var i,c;if(0===e.at)i=e.edge.a;else if(1===e.at)i=e.edge.b;else{var s=o.createArtificialVertexAndEdges(e),d=s.vertex,f=s.leftEdge,l=s.rightEdge;d.edges.push(f,l),i=d}if(0===t.at)c=t.edge.a;else if(1===t.at)c=t.edge.b;else{var v=o.createArtificialVertexAndEdges(t);d=v.vertex,f=v.leftEdge,l=v.rightEdge,d.edges.push(f,l),c=d,f.a.pathFind.artificialEdge=f,l.b.pathFind.artificialEdge=l}r||(r=function(e,t,r){return Math.abs(r.coords[0]-c.coords[0])+Math.abs(r.coords[1]-c.coords[1])});var p=function(e,t,r){var n=u++;a.clear(),e.pathFind.f=0,e.pathFind.g=0,e.pathFind.id=n,e.pathFind.parent=void 0,a.push(e,0);for(var i=a.pop();i&&i!==t;){for(var c=0,s=o.getVertexEdges(i);c<s.length;c++){var d=s[c],f=o.anotherEdgeVertex(d,i);f.pathFind.id!==n&&(f.pathFind.g=i.pathFind.g+d.length,f.pathFind.f=f.pathFind.g+r(i,d,f),f.pathFind.parent=i,f.pathFind.id=n,a.push(f,f.pathFind.f))}i=a.pop()}if(i){for(var l=[],v=i;v;)l.push(v),v=v.pathFind.parent;return l.reverse(),l}}(i,c,r);if(p){"artificial"===i.type&&(p[0]=o.anotherEdgeVertex(e.edge,p[1])),"artificial"===c.type&&(c.edges[0].a.pathFind.artificialEdge=void 0,c.edges[1].b.pathFind.artificialEdge=void 0,p[p.length-1]=o.anotherEdgeVertex(t.edge,p[p.length-2]));for(var h=[],g=0;g<p.length-1;g++){var m=p[g],y=p[g+1],b=n.findEdgeFromVertexToVertex(m,y);if(!b)throw new Error("Не найдена грань между вершинами: "+m.index+" и "+y.index);h.push(b)}var _=e.at,P=h[0];if(P.edge!==e.edge){if(0!==e.at&&1!==e.at)throw new Error("Первая грань составленная из вершин поиска пути "+P.edge.index+" не равна исходной "+e.edge.index);_=P.forward?0:1}var M=t.at,O=h[h.length-1];if(O.edge!==t.edge){if(0!==t.at&&1!==t.at)throw new Error("Последняя грань составленная из вершин поиска пути "+P.edge.index+" не равна исходной "+t.edge.index);M=O.forward?0:1}return{fromAt:_,toAt:M,edges:h}}},t.breadthFirstTraversalFromMidway=function(e,t){var r;if(0===e.at)r=e.edge.a;else if(1===e.at)r=e.edge.b;else{var c=o.createArtificialVertexAndEdges(e),s=c.vertex,d=c.leftEdge,f=c.rightEdge;s.edges.push(d,f),r=s}var l=function(e,t){var r=u++;a.clear();var n=new i.FlatQueue;e.pathFind.f=0,e.pathFind.g=0,e.pathFind.routeLength=0,e.pathFind.id=r,e.pathFind.parent=void 0,a.push(e,0),n.push(e,0);for(var c=a.pop();c;){for(var s=0,d=o.getVertexEdges(c);s<d.length;s++){var f=d[s],l=o.anotherEdgeVertex(f,c);if(l.pathFind.id!==r){var v=c.pathFind.routeLength+1,p=t(v,l,c,f);void 0!==p&&(l.pathFind.routeLength=v,l.pathFind.g=c.pathFind.g+p,l.pathFind.f=0,l.pathFind.parent=c,l.pathFind.id=r,a.push(l,l.pathFind.routeLength),n.push(l,-l.pathFind.g))}}c=a.pop()}for(var h=[],g=n.pop();g;)h.push(g),g=g.pathFind.parent;return h.reverse(),h}(r,t);if(l&&!(l.length<2)){"artificial"===r.type&&(l[0]=o.anotherEdgeVertex(e.edge,l[1]));for(var v=[],p=0;p<l.length-1;p++){var h=l[p],g=l[p+1],m=n.findEdgeFromVertexToVertex(h,g);if(!m)throw new Error("Не найдена грань между вершинами: "+h.index+" и "+g.index);v.push(m)}var y=e.at,b=v[0];if(b.edge!==e.edge){if(0!==e.at&&1!==e.at)throw new Error("Первая грань составленная из вершин поиска пути "+b.edge.index+" не равна исходной "+e.edge.index);y=b.forward?0:1}return{fromAt:y,edges:v,toAt:v[v.length-1].forward?1:0}}}},4842:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anotherEdgeVertex=t.getVertexEdges=t.createArtificialVertexAndEdges=void 0;var n=r(655);r(4087);var i=r(1460);r(9294),t.createArtificialVertexAndEdges=function(e){var t=i.getSegment(e.edge,e.at),r=t.segmentIndex,n={index:-1,coords:t.coords,type:"artificial",pathFind:{f:0,g:0,routeLength:0,id:-1,parent:void 0},edges:[],userData:{}},o=function(e,t,r){for(var n={index:-1,type:"artificial",length:0,geometry:[],a:e.a,b:r,userData:{}},i={index:-1,type:"artificial",length:0,geometry:[],a:r,b:e.b,userData:{}},o=0;o<e.geometry.length;o++)o<=t&&n.geometry.push(e.geometry[o]),o===t&&(n.geometry.push(r.coords),i.geometry.push(r.coords)),o>t&&i.geometry.push(e.geometry[o]);return{leftEdge:n,rightEdge:i}}(e.edge,r,n);return{vertex:n,leftEdge:o.leftEdge,rightEdge:o.rightEdge}},t.getVertexEdges=function(e){return e.pathFind.artificialEdge?n.__spreadArray([e.pathFind.artificialEdge],e.edges):e.edges},t.anotherEdgeVertex=function(e,t){return e.a===t?e.b:e.a}},9294:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Point=void 0;var n=r(655),i=r(7723);r(4087);var o=r(1460),a=r(4603);r(7558);var u=function(e){function t(t){var r=e.call(this)||this;return r.forward=!0,r.lastUpdateTime=0,r.speed=t.speed,r.userData=t.userData,r.position={edge:t.position.edge,at:t.position.at},r.route={fromAt:r.position.at,toAt:r.position.at,edges:[{edge:r.position.edge,forward:!0}]},r.edgeIndexInRoute=0,r}return n.__extends(t,e),t.prototype.moveTo=function(e){var t=a.pathfindFromMidway(this.position,e);t?this.setRoute(t):console.log("Not found route")},t.prototype.setRoute=function(e){var t=e.fromAt,r=e.edges,n=e.toAt;this.route.fromAt=t,this.route.edges=r,this.route.toAt=n,this.edgeIndexInRoute=0,this.position.at=t,this.position.edge=r[0].edge,this.forward=r[0].forward},t.prototype.getRoute=function(){return this.route},t.prototype.getSpeed=function(){return this.speed},t.prototype.getCoords=function(){return o.getSegment(this.position.edge,this.position.at).coords},t.prototype.getPosition=function(){return this.position},t.prototype.isFinishedRoute=function(){return this.edgeIndexInRoute===this.route.edges.length-1&&this.position.at===this.route.toAt},t.prototype.updateMoving=function(e){if(0!==this.lastUpdateTime){var t=this.position,r=this.speed*(e-this.lastUpdateTime);this.lastUpdateTime=e;var n=t.edge.length?r/t.edge.length:1,i=this.edgeIndexInRoute===this.route.edges.length-1;if(!i||t.at!==this.route.toAt){var o,a,u=t.edge;if(o=i?this.route.toAt:this.forward?1:0,this.forward?(t.at=t.at+n,a=o-t.at):(t.at=t.at-n,a=t.at-o),a<=0){if(i)t.at=this.route.toAt;else{this.edgeIndexInRoute++;var c=this.route.edges[this.edgeIndexInRoute];t.at=c.forward?0:1,t.edge=c.edge,this.forward=c.forward}this.isFinishedRoute()&&this.emit("routefinish")}this.emit("move",{edge:u,passedDistance:r})}}else this.lastUpdateTime=e},t}(i.EventEmitter);t.Point=u},6074:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Roads=void 0;var n=r(655),i=r(7134),o=r(8518),a=r(6009);r(4087);var u=r(1460),c=r(5502),s=r(9294),d={autoUpdate:!0},f=function(e){function t(t,r){void 0===r&&(r=d);var n=e.call(this)||this;return n.points=[],n.updateLoop=function(){requestAnimationFrame(n.updateLoop);var e=Date.now();n.update(e)},n.options=o.applyDefaults(r,d),n.graph=a.prepareGraph(t),n.vertexFinder=new c.VertexFinder(n.graph),n.options.autoUpdate&&requestAnimationFrame(n.updateLoop),n}return n.__extends(t,e),t.prototype.findNearestVertex=function(e,t){return void 0===t&&(t=1/0),this.vertexFinder.findNearest(e,t)},t.prototype.createPoint=function(e){var t=new s.Point(e);return this.points.push(t),t},t.prototype.removePoint=function(e){this.points=this.points.filter((function(t){return t!==e}))},t.prototype.getPositionCoords=function(e){return u.getSegment(e.edge,e.at).coords},t.prototype.update=function(e){this.points.forEach((function(t){return t.updateMoving(e)})),this.emit("update")},t}(i.EventEmitter);t.Roads=f},7558:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRouteGeometry=void 0,r(4087);var n=r(1460);function i(e,t,r){var i=[],o=n.getSegment(e,t),a=n.getSegment(e,r);if(i.push(o.coords),t<r)for(var u=o.segmentIndex+1;u<=a.segmentIndex;u++)i.push(e.geometry[u]);else for(u=o.segmentIndex;u>a.segmentIndex;u--)i.push(e.geometry[u]);return i.push(a.coords),i}t.getRouteGeometry=function(e){var t=e.fromAt,r=e.edges,n=e.toAt,o=[],a=r[0],u=r[r.length-1];if(a.edge===u.edge)o.push.apply(o,i(a.edge,t,n));else{o.push.apply(o,i(a.edge,t,a.forward?1:0));for(var c=1;c<r.length-1;c++){var s=r[c];if(s.forward)for(var d=0;d<s.edge.geometry.length-1;d++)o.push(s.edge.geometry[d]);else for(d=s.edge.geometry.length-1;d>0;d--)o.push(s.edge.geometry[d])}o.push.apply(o,i(u.edge,u.forward?0:1,n))}return o}},655:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__extends:()=>i,__assign:()=>o,__rest:()=>a,__decorate:()=>u,__param:()=>c,__metadata:()=>s,__awaiter:()=>d,__generator:()=>f,__createBinding:()=>l,__exportStar:()=>v,__values:()=>p,__read:()=>h,__spread:()=>g,__spreadArrays:()=>m,__spreadArray:()=>y,__await:()=>b,__asyncGenerator:()=>_,__asyncDelegator:()=>P,__asyncValues:()=>M,__makeTemplateObject:()=>O,__importStar:()=>j,__importDefault:()=>w,__classPrivateFieldGet:()=>E,__classPrivateFieldSet:()=>F});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function u(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function u(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function f(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var l=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||l(t,e,r)}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function m(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,u=o.length;a<u;a++,i++)n[i]=o[a];return n}function y(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||t)}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){o.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=i[e](t)).value instanceof b?Promise.resolve(r.value.v).then(c,s):d(o[0][2],r)}catch(e){d(o[0][3],e)}var r}function c(e){u("next",e)}function s(e){u("throw",e)}function d(e,t){e(t),o.shift(),o.length&&u(o[0][0],o[0][1])}}function P(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function M(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,i,(t=e[r](t)).done,t.value)}))}}}function O(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var x=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function j(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&l(t,e,r);return x(t,e),t}function w(e){return e&&e.__esModule?e:{default:e}}function E(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function F(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=r(7723),t=r(4432),n=[82.92494,55.0294],i=new mapgl.Map("map",{key:"042b5b75-f847-4f2a-b695-b5f58adc9dfd",center:n,zoom:14});function o(){return[n[0]+.06*(Math.random()-.5),n[1]+.03*(Math.random()-.5)]}window.addEventListener("resize",(function(){return i.invalidateSize()})),fetch("./data.json").then((function(e){return e.json()})).then((function(r){for(var n=new t.Roads(r),a=[],u=function(r){var u=n.findNearestVertex(e.mapPointFromLngLat(o()));if(u){var c=n.createPoint({position:u,speed:50}),s=function(){var t=n.findNearestVertex(e.mapPointFromLngLat(o()));t&&c.moveTo(t)};c.on("routefinish",s),s();var d,f=new mapgl.Marker(i,{coordinates:e.mapPointToLngLat(c.getCoords()),icon:"./icon.svg",size:[16,16],label:{text:""+r,offset:[0,0],fontSize:12},zIndex:1});c.on("move",(function(){var r=e.mapPointToLngLat(c.getCoords());f.setCoordinates(r),d&&d.destroy(),d=new mapgl.Polyline(i,{coordinates:t.getRouteGeometry(c.getRoute()).map((function(t){return e.mapPointToLngLat(t)})),color:"#ff000077",width:3,zIndex:0})})),a.push({point:c,marker:f})}},c=0;c<5;c++)u(c)}))})()})();