/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={8518:function(e,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.applyDefaults=void 0,t.applyDefaults=function(e,t){var n=r({},t);for(var o in e)void 0!==e[o]&&(n[o]=e[o]);return n}},9753:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=void 0,t.clamp=function(e,t,r){return e=Math.max(e,t),Math.min(e,r)}},7134:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0;var r=function(){function e(){this.events={}}return e.prototype.on=function(e,t){var r=this.events[e];return r||(r=this.events[e]=[]),r.push(t),this},e.prototype.once=function(e,t){var r=this,n=function(o){r.off(e,n),t.call(r,o)};return this.on(e,n),this},e.prototype.off=function(e,t){var r=this.events[e];if(!r)return this;var n=r.indexOf(t);return-1!==n&&r.splice(n,1),this},e.prototype.emit=function(e,t){var r=this.events[e];if(!r)return this;for(var n=r.slice(),o=0;o<n.length;o++)n[o].call(this,t);return this},e}();t.EventEmitter=r},1380:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nearestPointOnSegment=void 0,t.nearestPointOnSegment=function(e,t,r){var n=e[0]-t[0],o=e[1]-t[1],i=r[0]-t[0],a=r[1]-t[1],u=i*i+a*a,c=0!==u?(n*i+o*a)/u:0;return c<0?{point:t,t:0}:c>1?{point:r,t:1}:{point:[Math.round(t[0]+c*i),Math.round(t[1]+c*a)],t:c}}},740:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayShuffle=t.arrayInsert=void 0;var n=r(950);Object.defineProperty(t,"arrayInsert",{enumerable:!0,get:function(){return n.arrayInsert}});var o=r(9046);Object.defineProperty(t,"arrayShuffle",{enumerable:!0,get:function(){return o.arrayShuffle}})},950:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayInsert=void 0,t.arrayInsert=function(e,t,r){var n=e.slice(0,t),o=e.slice(t);return n.push(r),n.concat(o)}},9046:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayShuffle=void 0,t.arrayShuffle=function(e,t){void 0===t&&(t=Math.random);for(var r=e.slice(),n=0;n<r.length;n++){var o=n+Math.floor(t()*(r.length-n)),i=r[n];r[n]=r[o],r[o]=i}return r}},1535:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.affineStep=void 0;var n=r(9935);t.affineStep=function(e,t,r){return n.clamp((r-e)/(t-e),0,1)}},590:function(e,t){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.applyDefaults=void 0,t.applyDefaults=function(e,t){var n=r({},t);for(var o in e)void 0!==e[o]&&(n[o]=e[o]);return n}},7279:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.circleIcon=void 0,t.circleIcon=function(e,t,r,n){return void 0===r&&(r="#000"),void 0===n&&(n=0),"data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="'+2*t+'" height="'+2*t+'" viewBox="0 0 '+2*t+" "+2*t+'">\n        <circle fill="'+e+'" cx="'+t+'" cy="'+t+'" r="'+t+'"/>\n        <circle fill="'+r+'" cx="'+t+'" cy="'+t+'" r="'+n+'"/>\n    </svg>')}},9935:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clamp=void 0,t.clamp=function(e,t,r){return e=Math.max(e,t),Math.min(e,r)}},7996:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.degToRad=void 0,t.degToRad=function(e){return e*Math.PI/180}},4474:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0;var r=function(){function e(){this.events={}}return e.prototype.on=function(e,t){var r=this.events[e];return r||(r=this.events[e]=[]),r.push(t),this},e.prototype.once=function(e,t){var r=this,n=function(o){r.off(e,n),t.call(r,o)};return this.on(e,n),this},e.prototype.off=function(e,t){var r=this.events[e];if(!r)return this;var n=r.indexOf(t);return-1!==n&&r.splice(n,1),this},e.prototype.emit=function(e,t){var r=this.events[e];if(!r)return this;for(var n=r.slice(),o=0;o<n.length;o++)n[o].call(this,t);return this},e}();t.EventEmitter=r},9875:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=t.sign=t.round=t.radToDeg=t.pick=t.nearestPointOnSegment=t.EventEmitter=t.degToRad=t.clamp=t.circleIcon=t.applyDefaults=t.affineStep=void 0;var n=r(1535);Object.defineProperty(t,"affineStep",{enumerable:!0,get:function(){return n.affineStep}});var o=r(590);Object.defineProperty(t,"applyDefaults",{enumerable:!0,get:function(){return o.applyDefaults}});var i=r(7279);Object.defineProperty(t,"circleIcon",{enumerable:!0,get:function(){return i.circleIcon}});var a=r(9935);Object.defineProperty(t,"clamp",{enumerable:!0,get:function(){return a.clamp}});var u=r(7996);Object.defineProperty(t,"degToRad",{enumerable:!0,get:function(){return u.degToRad}});var c=r(4474);Object.defineProperty(t,"EventEmitter",{enumerable:!0,get:function(){return c.EventEmitter}});var s=r(1883);Object.defineProperty(t,"nearestPointOnSegment",{enumerable:!0,get:function(){return s.nearestPointOnSegment}});var d=r(1758);Object.defineProperty(t,"pick",{enumerable:!0,get:function(){return d.pick}});var f=r(7461);Object.defineProperty(t,"radToDeg",{enumerable:!0,get:function(){return f.radToDeg}});var l=r(1152);Object.defineProperty(t,"round",{enumerable:!0,get:function(){return l.round}});var v=r(4290);Object.defineProperty(t,"sign",{enumerable:!0,get:function(){return v.sign}});var p=r(1702);Object.defineProperty(t,"throttle",{enumerable:!0,get:function(){return p.throttle}})},1883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nearestPointOnSegment=void 0,t.nearestPointOnSegment=function(e,t,r){var n=e[0]-t[0],o=e[1]-t[1],i=r[0]-t[0],a=r[1]-t[1],u=i*i+a*a,c=0!==u?(n*i+o*a)/u:0;return c<0?{point:t,t:0}:c>1?{point:r,t:1}:{point:[Math.round(t[0]+c*i),Math.round(t[1]+c*a)],t:c}}},1758:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pick=void 0,t.pick=function(e,t){for(var r={},n=0;n<t.length;n++)r[t[n]]=e[t[n]];return r}},7461:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.radToDeg=void 0,t.radToDeg=function(e){return e/Math.PI*180}},1152:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.round=void 0,t.round=function(e,t){void 0===t&&(t=0);var r=Math.pow(10,t);return Math.round(e*r)/r}},4290:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sign=void 0,t.sign=function(e){return 0==(e=+e)||Number.isNaN(e)?e:e>0?1:-1}},1702:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=void 0,t.throttle=function(e,t,r){var n,o=!1;function i(){o=!1,n&&(a.apply(r,n),n=void 0)}function a(){for(var a=[],u=0;u<arguments.length;u++)a[u]=arguments[u];o?n=a:(e.apply(r,a),setTimeout(i,t),o=!0)}return a}},5545:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coordinatesPrecision=void 0,t.coordinatesPrecision=function(e){return Math.ceil((e*Math.LN2+Math.log(256/360/.5))/Math.LN10)}},4001:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.geoDistance=void 0,t.geoDistance=function(e,t){var r=Math.PI/180,n=e[1]*r,o=t[1]*r,i=Math.sin((t[1]-e[1])*r/2),a=Math.sin((t[0]-e[0])*r/2),u=i*i+Math.cos(n)*Math.cos(o)*a*a,c=2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u));return Math.round(6371e3*c)}},943:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coordinatesPrecision=t.geoDistance=void 0;var n=r(4001);Object.defineProperty(t,"geoDistance",{enumerable:!0,get:function(){return n.geoDistance}});var o=r(5545);Object.defineProperty(t,"coordinatesPrecision",{enumerable:!0,get:function(){return o.coordinatesPrecision}})},7723:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(740),t),o(r(9875),t),o(r(943),t),o(r(3367),t),o(r(8999),t),o(r(4060),t),o(r(5610),t),o(r(7495),t),o(r(2083),t),o(r(8123),t)},1775:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapFind=void 0,t.mapFind=function(e,t){for(var r=e.entries(),n=r.next();!n.done;){var o=n.value,i=o[0],a=o[1];if(t(a,i))return a;n=r.next()}}},3367:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapMap=t.mapFind=void 0;var n=r(1775);Object.defineProperty(t,"mapFind",{enumerable:!0,get:function(){return n.mapFind}});var o=r(5340);Object.defineProperty(t,"mapMap",{enumerable:!0,get:function(){return o.mapMap}})},5340:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapMap=void 0,t.mapMap=function(e,t){var r=[];return e.forEach((function(e,n){return r.push(t(e,n))})),r}},3131:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worldSize=void 0,t.worldSize=Math.pow(2,32)},8523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapPointFromLngLat=void 0;var n=r(3131),o=r(9935),i=r(7996);t.mapPointFromLngLat=function(e){var t=Math.sin(i.degToRad(e[1])),r=e[0]*n.worldSize/360,a=Math.log((1+t)/(1-t))*n.worldSize/(4*Math.PI),u=n.worldSize/2;return[o.clamp(r,-u,u),o.clamp(a,-u,u)]}},8999:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapPointToLngLat=t.mapPointFromLngLat=void 0;var n=r(8523);Object.defineProperty(t,"mapPointFromLngLat",{enumerable:!0,get:function(){return n.mapPointFromLngLat}});var o=r(4175);Object.defineProperty(t,"mapPointToLngLat",{enumerable:!0,get:function(){return o.mapPointToLngLat}})},4175:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapPointToLngLat=void 0;var n=r(3131),o=r(7461);t.mapPointToLngLat=function(e){var t=-2*Math.PI/n.worldSize;return[360*e[0]/n.worldSize,90-2*o.radToDeg(Math.atan(Math.exp(e[1]*t)))]}},9645:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createRandomFunction=void 0,t.createRandomFunction=function(e){return function(){return((e=16807*e%2147483647)-1)/2147483646}}},4060:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomSeed=t.createRandomFunction=void 0;var n=r(9645);Object.defineProperty(t,"createRandomFunction",{enumerable:!0,get:function(){return n.createRandomFunction}});var o=r(9597);Object.defineProperty(t,"randomSeed",{enumerable:!0,get:function(){return o.randomSeed}})},9597:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomSeed=void 0,t.randomSeed=function(){return Math.round(2147483647*Math.random())}},5610:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.percentile=t.p90=t.p75=t.p25=t.median=void 0;var n=r(3645);Object.defineProperty(t,"median",{enumerable:!0,get:function(){return n.median}});var o=r(4523);Object.defineProperty(t,"p25",{enumerable:!0,get:function(){return o.p25}});var i=r(9241);Object.defineProperty(t,"p75",{enumerable:!0,get:function(){return i.p75}});var a=r(699);Object.defineProperty(t,"p90",{enumerable:!0,get:function(){return a.p90}});var u=r(193);Object.defineProperty(t,"percentile",{enumerable:!0,get:function(){return u.percentile}})},3645:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.median=void 0;var n=r(193);t.median=function(e){return n.percentile(e,.5)}},4523:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p25=void 0;var n=r(193);t.p25=function(e){return n.percentile(e,.25)}},9241:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p75=void 0;var n=r(193);t.p75=function(e){return n.percentile(e,.75)}},699:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.p90=void 0;var n=r(193);t.p90=function(e){return n.percentile(e,.9)}},193:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.percentile=void 0,t.percentile=function(e,t){var r=e.slice();return r.sort((function(e,t){return e-t})),r[Math.floor(r.length*t)]}},7775:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2angle=void 0,t.vec2angle=function(e){return Math.atan2(e[1],e[0])}},4853:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2copy=void 0,t.vec2copy=function(e,t){e[0]=t[0],e[1]=t[1]}},4852:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2create=void 0,t.vec2create=function(){return[0,0]}},1624:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2cross=void 0,t.vec2cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];e[0]=e[1]=0,e[2]=n}},495:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2dist=void 0,t.vec2dist=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}},7428:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2dot=void 0,t.vec2dot=function(e,t){return e[0]*t[0]+e[1]*t[1]}},6998:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2equals=void 0,t.vec2equals=function(e,t,r){return void 0===r&&(r=1e-6),Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r}},506:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2exactEquals=void 0,t.vec2exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]}},7495:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2set=t.vec2rotate=t.vec2normalize=t.vec2max=t.vec2min=t.vec2lerp=t.vec2length=t.vec2exactEquals=t.vec2equals=t.vec2dot=t.vec2dist=t.vec2cross=t.vec2create=t.vec2copy=t.vec2angle=void 0;var n=r(7775);Object.defineProperty(t,"vec2angle",{enumerable:!0,get:function(){return n.vec2angle}});var o=r(4853);Object.defineProperty(t,"vec2copy",{enumerable:!0,get:function(){return o.vec2copy}});var i=r(4852);Object.defineProperty(t,"vec2create",{enumerable:!0,get:function(){return i.vec2create}});var a=r(1624);Object.defineProperty(t,"vec2cross",{enumerable:!0,get:function(){return a.vec2cross}});var u=r(495);Object.defineProperty(t,"vec2dist",{enumerable:!0,get:function(){return u.vec2dist}});var c=r(7428);Object.defineProperty(t,"vec2dot",{enumerable:!0,get:function(){return c.vec2dot}});var s=r(6998);Object.defineProperty(t,"vec2equals",{enumerable:!0,get:function(){return s.vec2equals}});var d=r(506);Object.defineProperty(t,"vec2exactEquals",{enumerable:!0,get:function(){return d.vec2exactEquals}});var f=r(581);Object.defineProperty(t,"vec2length",{enumerable:!0,get:function(){return f.vec2length}});var l=r(2862);Object.defineProperty(t,"vec2lerp",{enumerable:!0,get:function(){return l.vec2lerp}});var v=r(2608);Object.defineProperty(t,"vec2min",{enumerable:!0,get:function(){return v.vec2min}});var p=r(2090);Object.defineProperty(t,"vec2max",{enumerable:!0,get:function(){return p.vec2max}});var h=r(5873);Object.defineProperty(t,"vec2normalize",{enumerable:!0,get:function(){return h.vec2normalize}});var m=r(2020);Object.defineProperty(t,"vec2rotate",{enumerable:!0,get:function(){return m.vec2rotate}});var g=r(3883);Object.defineProperty(t,"vec2set",{enumerable:!0,get:function(){return g.vec2set}})},581:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2length=void 0,t.vec2length=function(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}},2862:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2lerp=void 0,t.vec2lerp=function(e,t,r,n){var o=t[0],i=t[1];e[0]=o+n*(r[0]-o),e[1]=i+n*(r[1]-i)}},2090:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2max=void 0,t.vec2max=function(e,t,r){e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1])}},2608:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2min=void 0,t.vec2min=function(e,t,r){e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1])}},5873:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2normalize=void 0,t.vec2normalize=function(e,t){var r=t[0],n=t[1],o=r*r+n*n;o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o)}},2020:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2rotate=void 0,t.vec2rotate=function(e,t,r){var n=t[0],o=t[1];e[0]=n*Math.cos(r)+o*Math.sin(r),e[1]=-n*Math.sin(r)+o*Math.cos(r)}},3883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2set=void 0,t.vec2set=function(e,t,r){e[0]=t,e[1]=r}},6666:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3copy=void 0,t.vec3copy=function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2]}},8164:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3create=void 0,t.vec3create=function(){return[0,0,0]}},7648:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3dist=void 0,t.vec3dist=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(r*r+n*n+o*o)}},3440:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3equals=void 0,t.vec3equals=function(e,t,r){return void 0===r&&(r=1e-6),Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r}},8876:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3exactEquals=void 0,t.vec3exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},2083:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3set=t.vec3normalize=t.vec3max=t.vec3min=t.vec3lerp=t.vec3exactEquals=t.vec3equals=t.vec3dist=t.vec3create=t.vec3copy=void 0;var n=r(6666);Object.defineProperty(t,"vec3copy",{enumerable:!0,get:function(){return n.vec3copy}});var o=r(8164);Object.defineProperty(t,"vec3create",{enumerable:!0,get:function(){return o.vec3create}});var i=r(7648);Object.defineProperty(t,"vec3dist",{enumerable:!0,get:function(){return i.vec3dist}});var a=r(3440);Object.defineProperty(t,"vec3equals",{enumerable:!0,get:function(){return a.vec3equals}});var u=r(8876);Object.defineProperty(t,"vec3exactEquals",{enumerable:!0,get:function(){return u.vec3exactEquals}});var c=r(4034);Object.defineProperty(t,"vec3lerp",{enumerable:!0,get:function(){return c.vec3lerp}});var s=r(5348);Object.defineProperty(t,"vec3min",{enumerable:!0,get:function(){return s.vec3min}});var d=r(8430);Object.defineProperty(t,"vec3max",{enumerable:!0,get:function(){return d.vec3max}});var f=r(342);Object.defineProperty(t,"vec3normalize",{enumerable:!0,get:function(){return f.vec3normalize}});var l=r(1245);Object.defineProperty(t,"vec3set",{enumerable:!0,get:function(){return l.vec3set}})},4034:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3lerp=void 0,t.vec3lerp=function(e,t,r,n){var o=t[0],i=t[1],a=t[2];e[0]=o+n*(r[0]-o),e[1]=i+n*(r[1]-i),e[2]=a+n*(r[2]-a)}},8430:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3max=void 0,t.vec3max=function(e,t,r){e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2])}},5348:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3min=void 0,t.vec3min=function(e,t,r){e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2])}},342:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3normalize=void 0,t.vec3normalize=function(e,t){var r=t[0],n=t[1],o=t[2],i=r*r+n*n+o*o;i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i)}},1245:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec3set=void 0,t.vec3set=function(e,t,r,n){e[0]=t,e[1]=r,e[2]=n}},331:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4copy=void 0,t.vec4copy=function(e,t){e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]}},59:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4create=void 0,t.vec4create=function(){return[0,0,0,0]}},8025:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4dist=void 0,t.vec4dist=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2],i=t[3]-e[3];return Math.sqrt(r*r+n*n+o*o+i*i)}},6106:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4equals=void 0,t.vec4equals=function(e,t,r){return void 0===r&&(r=1e-6),Math.abs(e[0]-t[0])<=r&&Math.abs(e[1]-t[1])<=r&&Math.abs(e[2]-t[2])<=r&&Math.abs(e[3]-t[3])<=r}},7122:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4exactEquals=void 0,t.vec4exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}},8123:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4set=t.vec4normalize=t.vec4max=t.vec4min=t.vec4lerp=t.vec4exactEquals=t.vec4equals=t.vec4dist=t.vec4create=t.vec4copy=void 0;var n=r(331);Object.defineProperty(t,"vec4copy",{enumerable:!0,get:function(){return n.vec4copy}});var o=r(59);Object.defineProperty(t,"vec4create",{enumerable:!0,get:function(){return o.vec4create}});var i=r(8025);Object.defineProperty(t,"vec4dist",{enumerable:!0,get:function(){return i.vec4dist}});var a=r(6106);Object.defineProperty(t,"vec4equals",{enumerable:!0,get:function(){return a.vec4equals}});var u=r(7122);Object.defineProperty(t,"vec4exactEquals",{enumerable:!0,get:function(){return u.vec4exactEquals}});var c=r(356);Object.defineProperty(t,"vec4lerp",{enumerable:!0,get:function(){return c.vec4lerp}});var s=r(2071);Object.defineProperty(t,"vec4min",{enumerable:!0,get:function(){return s.vec4min}});var d=r(868);Object.defineProperty(t,"vec4max",{enumerable:!0,get:function(){return d.vec4max}});var f=r(8883);Object.defineProperty(t,"vec4normalize",{enumerable:!0,get:function(){return f.vec4normalize}});var l=r(7040);Object.defineProperty(t,"vec4set",{enumerable:!0,get:function(){return l.vec4set}})},356:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4lerp=void 0,t.vec4lerp=function(e,t,r,n){var o=t[0],i=t[1],a=t[2],u=t[3];e[0]=o+n*(r[0]-o),e[1]=i+n*(r[1]-i),e[2]=a+n*(r[2]-a),e[3]=u+n*(r[3]-u)}},868:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4max=void 0,t.vec4max=function(e,t,r){e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3])}},2071:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4min=void 0,t.vec4min=function(e,t,r){e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3])}},8883:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4normalize=void 0,t.vec4normalize=function(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],a=r*r+n*n+o*o+i*i;a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a)}},7040:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec4set=void 0,t.vec4set=function(e,t,r,n,o){e[0]=t,e[1]=r,e[2]=n,e[3]=o}},691:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2dist=void 0,t.vec2dist=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}},457:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vec2lerp=void 0,t.vec2lerp=function(e,t,r,n){var o=t[0],i=t[1];e[0]=o+n*(r[0]-o),e[1]=i+n*(r[1]-i)}},2582:function(e){e.exports=function(){"use strict";function e(e,n,o,i,a){!function e(r,n,o,i,a){for(;i>o;){if(i-o>600){var u=i-o+1,c=n-o+1,s=Math.log(u),d=.5*Math.exp(2*s/3),f=.5*Math.sqrt(s*d*(u-d)/u)*(c-u/2<0?-1:1);e(r,n,Math.max(o,Math.floor(n-c*d/u+f)),Math.min(i,Math.floor(n+(u-c)*d/u+f)),a)}var l=r[n],v=o,p=i;for(t(r,o,n),a(r[i],l)>0&&t(r,o,i);v<p;){for(t(r,v,p),v++,p--;a(r[v],l)<0;)v++;for(;a(r[p],l)>0;)p--}0===a(r[o],l)?t(r,o,p):t(r,++p,i),p<=n&&(o=p+1),n<=p&&(i=p-1)}}(e,n,o||0,i||e.length-1,a||r)}function t(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function r(e,t){return e<t?-1:e>t?1:0}var n=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function o(e,t,r){if(!r)return t.indexOf(e);for(var n=0;n<t.length;n++)if(r(e,t[n]))return n;return-1}function i(e,t){a(e,0,e.children.length,t,e)}function a(e,t,r,n,o){o||(o=p(null)),o.minX=1/0,o.minY=1/0,o.maxX=-1/0,o.maxY=-1/0;for(var i=t;i<r;i++){var a=e.children[i];u(o,e.leaf?n(a):a)}return o}function u(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function c(e,t){return e.minX-t.minX}function s(e,t){return e.minY-t.minY}function d(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function l(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function v(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function p(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function h(t,r,n,o,i){for(var a=[r,n];a.length;)if(!((n=a.pop())-(r=a.pop())<=o)){var u=r+Math.ceil((n-r)/o/2)*o;e(t,u,r,n,i),a.push(r,u,u,n)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(e){var t=this.data,r=[];if(!v(e,t))return r;for(var n=this.toBBox,o=[];t;){for(var i=0;i<t.children.length;i++){var a=t.children[i],u=t.leaf?n(a):a;v(e,u)&&(t.leaf?r.push(a):l(e,u)?this._all(a,r):o.push(a))}t=o.pop()}return r},n.prototype.collides=function(e){var t=this.data;if(!v(e,t))return!1;for(var r=[];t;){for(var n=0;n<t.children.length;n++){var o=t.children[n],i=t.leaf?this.toBBox(o):o;if(v(e,i)){if(t.leaf||l(e,i))return!0;r.push(o)}}t=r.pop()}return!1},n.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var n=this.data;this.data=r,r=n}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},n.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},n.prototype.clear=function(){return this.data=p([]),this},n.prototype.remove=function(e,t){if(!e)return this;for(var r,n,i,a=this.data,u=this.toBBox(e),c=[],s=[];a||c.length;){if(a||(a=c.pop(),n=c[c.length-1],r=s.pop(),i=!0),a.leaf){var d=o(e,a.children,t);if(-1!==d)return a.children.splice(d,1),c.push(a),this._condense(c),this}i||a.leaf||!l(a,u)?n?(r++,a=n.children[r],i=!1):a=null:(c.push(a),s.push(r),r=0,n=a,a=a.children[0])}return this},n.prototype.toBBox=function(e){return e},n.prototype.compareMinX=function(e,t){return e.minX-t.minX},n.prototype.compareMinY=function(e,t){return e.minY-t.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(e){return this.data=e,this},n.prototype._all=function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},n.prototype._build=function(e,t,r,n){var o,a=r-t+1,u=this._maxEntries;if(a<=u)return i(o=p(e.slice(t,r+1)),this.toBBox),o;n||(n=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,n-1))),(o=p([])).leaf=!1,o.height=n;var c=Math.ceil(a/u),s=c*Math.ceil(Math.sqrt(u));h(e,t,r,s,this.compareMinX);for(var d=t;d<=r;d+=s){var f=Math.min(d+s-1,r);h(e,d,f,c,this.compareMinY);for(var l=d;l<=f;l+=c){var v=Math.min(l+c-1,f);o.children.push(this._build(e,l,v,n-1))}}return i(o,this.toBBox),o},n.prototype._chooseSubtree=function(e,t,r,n){for(;n.push(t),!t.leaf&&n.length-1!==r;){for(var o=1/0,i=1/0,a=void 0,u=0;u<t.children.length;u++){var c=t.children[u],s=d(c),f=(l=e,v=c,(Math.max(v.maxX,l.maxX)-Math.min(v.minX,l.minX))*(Math.max(v.maxY,l.maxY)-Math.min(v.minY,l.minY))-s);f<i?(i=f,o=s<o?s:o,a=c):f===i&&s<o&&(o=s,a=c)}t=a||t.children[0]}var l,v;return t},n.prototype._insert=function(e,t,r){var n=r?e:this.toBBox(e),o=[],i=this._chooseSubtree(n,this.data,t,o);for(i.children.push(e),u(i,n);t>=0&&o[t].children.length>this._maxEntries;)this._split(o,t),t--;this._adjustParentBBoxes(n,o,t)},n.prototype._split=function(e,t){var r=e[t],n=r.children.length,o=this._minEntries;this._chooseSplitAxis(r,o,n);var a=this._chooseSplitIndex(r,o,n),u=p(r.children.splice(a,r.children.length-a));u.height=r.height,u.leaf=r.leaf,i(r,this.toBBox),i(u,this.toBBox),t?e[t-1].children.push(u):this._splitRoot(r,u)},n.prototype._splitRoot=function(e,t){this.data=p([e,t]),this.data.height=e.height+1,this.data.leaf=!1,i(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(e,t,r){for(var n,o,i,u,c,s,f,l=1/0,v=1/0,p=t;p<=r-t;p++){var h=a(e,0,p,this.toBBox),m=a(e,p,r,this.toBBox),g=(o=h,i=m,void 0,void 0,void 0,void 0,u=Math.max(o.minX,i.minX),c=Math.max(o.minY,i.minY),s=Math.min(o.maxX,i.maxX),f=Math.min(o.maxY,i.maxY),Math.max(0,s-u)*Math.max(0,f-c)),y=d(h)+d(m);g<l?(l=g,n=p,v=y<v?y:v):g===l&&y<v&&(v=y,n=p)}return n||r-t},n.prototype._chooseSplitAxis=function(e,t,r){var n=e.leaf?this.compareMinX:c,o=e.leaf?this.compareMinY:s;this._allDistMargin(e,t,r,n)<this._allDistMargin(e,t,r,o)&&e.children.sort(n)},n.prototype._allDistMargin=function(e,t,r,n){e.children.sort(n);for(var o=this.toBBox,i=a(e,0,t,o),c=a(e,r-t,r,o),s=f(i)+f(c),d=t;d<r-t;d++){var l=e.children[d];u(i,e.leaf?o(l):l),s+=f(i)}for(var v=r-t-1;v>=t;v--){var p=e.children[v];u(c,e.leaf?o(p):p),s+=f(c)}return s},n.prototype._adjustParentBBoxes=function(e,t,r){for(var n=r;n>=0;n--)u(t[n],e)},n.prototype._condense=function(e){for(var t=e.length-1,r=void 0;t>=0;t--)0===e[t].children.length?t>0?(r=e[t-1].children).splice(r.indexOf(e[t]),1):this.clear():i(e[t],this.toBBox)},n}()},6009:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.prepareGraph=void 0;var n=r(691);r(4087);var o=r(1200);t.prepareGraph=function(e){o.unpackGraph(e);var t=e;return e.vertices.forEach((function(e,r){var n=e;n.index=r,n.edges=e.edges.map((function(e){return t.edges[e]})),n.pathFind={f:0,g:0,id:-1,routeLength:0,parent:void 0}})),e.edges.forEach((function(e,r){var o=e;o.index=r,o.pollution=0,o.enabled=!1,o.a=t.vertices[e.a],o.b=t.vertices[e.b],o.length=function(e){for(var t=0,r=1;r<e.length;r++)t+=n.vec2dist(e[r-1],e[r]);return t}(o.geometry)})),t}},4087:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1200:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unpackGraph=void 0,r(4087);var n=100;t.unpackGraph=function(e){1!==e.formatVersion&&console.warn("Supported format version is only 1, but data graph format version is "+e.formatVersion);var t=0,r=0;function o(e){t=e[0]=e[0]+t,r=e[1]=e[1]+r}var i=0;function a(e){return i=e+i}e.vertices.forEach((function(t){o(t.coords),t.coords[0]=t.coords[0]*n,t.coords[1]=t.coords[1]*n,t.coords[0]=t.coords[0]+e.center[0],t.coords[1]=t.coords[1]+e.center[1],t.edges=t.edges.map(a)})),e.edges.forEach((function(t){t.a=a(t.a),t.b=a(t.b),void 0===t.geometry?t.geometry=[e.vertices[t.a].coords,e.vertices[t.b].coords]:t.geometry.forEach((function(t){o(t),t[0]=t[0]*n,t[1]=t[1]*n,t[0]=t[0]+e.center[0],t[1]=t[1]+e.center[1]}))}))}},1460:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAtFromSegment=t.getSegment=t.findEdgeFromVertexToVertex=void 0;var n=r(9753),o=r(691),i=r(457);r(4087),t.findEdgeFromVertexToVertex=function(e,t){for(var r=0,n=e.edges;r<n.length;r++){var o=n[r];if(o.a===e&&o.b===t)return{edge:o,forward:!0};if(o.a===t&&o.b===e)return{edge:o,forward:!1}}},t.getSegment=function(e,t){for(var r=e.length,a=e.geometry,u=r*t,c=0,s=0;s<a.length-1;s++){var d=o.vec2dist(a[s],a[s+1]);if(c+d>=u){var f=[0,0],l=d>0?n.clamp((u-c)/d,0,1):0;return i.vec2lerp(f,a[s],a[s+1],l),{segmentIndex:s,positionAtSegment:l,coords:f}}c+=d}return{segmentIndex:0,positionAtSegment:0,coords:[0,0]}},t.getAtFromSegment=function(e,t,r){for(var n=e.length,i=e.geometry,a=0,u=0;u<r;u++)a+=o.vec2dist(i[u],i[u+1]);return(a+=o.vec2dist(i[r],i[r+1])*t)/n}},5502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VertexFinder=void 0;var n=r(655),o=r(1380),i=r(691),a=n.__importDefault(r(2582));r(4087);var u=r(1460),c=function(){function e(e){this.graph=e,this.tree=new a.default,this.tree.load(this.graph.vertices.map((function(e){return function(e,t){return{minX:e[0],minY:e[1],maxX:e[0],maxY:e[1],vertex:t}}(e.coords,e)})))}return e.prototype.findVertices=function(e,t){return this.tree.search(s(e,t)).map((function(e){return e.vertex}))},e.prototype.findNearest=function(e,t){var r=this;void 0===t&&(t=1/0);for(var n,a=this.tree.search(s(e,131072)).map((function(e){return e.vertex})),c=new Set,d=0,f=a;d<f.length;d++)for(var l=0,v=f[d].edges;l<v.length;l++){var p=v[l];c.add(p.index)}if(c.forEach((function(a){for(var u=r.graph.edges[a],c=0;c<u.geometry.length-1;c++){var s=o.nearestPointOnSegment(e,u.geometry[c],u.geometry[c+1]),d=i.vec2dist(e,s.point);d<t&&(t=d,n={edge:u,segmentIndex:c,positionAtSegment:s.t,coords:s.point})}})),n)return{edge:n.edge,segmentIndex:n.segmentIndex,positionAtSegment:n.positionAtSegment,coords:n.coords,at:u.getAtFromSegment(n.edge,n.positionAtSegment,n.segmentIndex)}},e}();function s(e,t){return{minX:e[0]-t,minY:e[1]-t,maxX:e[0]+t,maxY:e[1]+t}}t.VertexFinder=c},4432:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PathfindHeuristicFunction=t.breadthFirstTraversal=t.getRouteGeometry=t.Route=t.PointEvents=t.Point=t.PointPosition=t.PointInitialData=t.DataGraphVertex=t.DataGraphEdge=t.DataGraph=t.ClientGraphVertex=t.ClientGraphEdge=t.ClientGraph=t.RoadsOptions=t.RoadsEvents=t.Roads=void 0;var n=r(6074);Object.defineProperty(t,"Roads",{enumerable:!0,get:function(){return n.Roads}}),Object.defineProperty(t,"RoadsEvents",{enumerable:!0,get:function(){return n.RoadsEvents}}),Object.defineProperty(t,"RoadsOptions",{enumerable:!0,get:function(){return n.RoadsOptions}});var o=r(4087);Object.defineProperty(t,"ClientGraph",{enumerable:!0,get:function(){return o.ClientGraph}}),Object.defineProperty(t,"ClientGraphEdge",{enumerable:!0,get:function(){return o.ClientGraphEdge}}),Object.defineProperty(t,"ClientGraphVertex",{enumerable:!0,get:function(){return o.ClientGraphVertex}}),Object.defineProperty(t,"DataGraph",{enumerable:!0,get:function(){return o.DataGraph}}),Object.defineProperty(t,"DataGraphEdge",{enumerable:!0,get:function(){return o.DataGraphEdge}}),Object.defineProperty(t,"DataGraphVertex",{enumerable:!0,get:function(){return o.DataGraphVertex}});var i=r(9294);Object.defineProperty(t,"PointInitialData",{enumerable:!0,get:function(){return i.PointInitialData}}),Object.defineProperty(t,"PointPosition",{enumerable:!0,get:function(){return i.PointPosition}}),Object.defineProperty(t,"Point",{enumerable:!0,get:function(){return i.Point}}),Object.defineProperty(t,"PointEvents",{enumerable:!0,get:function(){return i.PointEvents}});var a=r(7558);Object.defineProperty(t,"Route",{enumerable:!0,get:function(){return a.Route}}),Object.defineProperty(t,"getRouteGeometry",{enumerable:!0,get:function(){return a.getRouteGeometry}});var u=r(4603);Object.defineProperty(t,"breadthFirstTraversal",{enumerable:!0,get:function(){return u.breadthFirstTraversal}}),Object.defineProperty(t,"PathfindHeuristicFunction",{enumerable:!0,get:function(){return u.PathfindHeuristicFunction}})},225:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FlatQueue=void 0;var r=function(){function e(){this.ids=[],this.values=[],this.length=0}return e.prototype.clear=function(){this.length=0},e.prototype.push=function(e,t){var r=this.length++;for(this.ids[r]=e,this.values[r]=t;r>0;){var n=r-1>>1,o=this.values[n];if(t>=o)break;this.ids[r]=this.ids[n],this.values[r]=o,r=n}this.ids[r]=e,this.values[r]=t},e.prototype.pop=function(){if(0!==this.length){var e=this.ids[0];if(this.length--,this.length>0){for(var t=this.ids[0]=this.ids[this.length],r=this.values[0]=this.values[this.length],n=this.length>>1,o=0;o<n;){var i=1+(o<<1),a=i+1,u=this.ids[i],c=this.values[i],s=this.values[a];if(a<this.length&&s<c&&(i=a,u=this.ids[a],c=s),c>=r)break;this.ids[o]=u,this.values[o]=c,o=i}this.ids[o]=t,this.values[o]=r}return e}},e.prototype.peek=function(){return this.ids[0]},e.prototype.peekValue=function(){return this.values[0]},e}();t.FlatQueue=r},4603:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breadthFirstTraversal=t.pathfindFromMidway=void 0;var n=r(655);r(4087);var o=r(1460);r(9294),r(7558);var i=r(225),a=new i.FlatQueue,u=0;function c(e){var t=o.getSegment(e.edge,e.at),r=t.segmentIndex,n={index:-1,coords:t.coords,type:"artificial",pathFind:{f:0,g:0,routeLength:0,id:-1,parent:void 0},edges:[]},i=function(e,t,r){for(var n={index:-1,enabled:!0,type:"artificial",pollution:0,length:0,geometry:[],a:e.a,b:r},o={index:-1,enabled:!0,type:"artificial",pollution:0,length:0,geometry:[],a:r,b:e.b},i=0;i<e.geometry.length;i++)i<=t&&n.geometry.push(e.geometry[i]),i===t&&(n.geometry.push(r.coords),o.geometry.push(r.coords)),i>t&&o.geometry.push(e.geometry[i]);return{leftEdge:n,rightEdge:o}}(e.edge,r,n);return{vertex:n,leftEdge:i.leftEdge,rightEdge:i.rightEdge}}function s(e){return e.pathFind.artificialEdge?n.__spreadArray([e.pathFind.artificialEdge],e.edges):e.edges}function d(e,t){return e.a===t?e.b:e.a}t.pathfindFromMidway=function(e,t,r){if(e.edge===t.edge){var n=e.edge,o=n.a,i=n.b,f=e.at<t.at?[o,i]:[i,o];return{fromAt:e.at,toAt:t.at,vertices:f}}var l,v;if(0===e.at)l=e.edge.a;else if(1===e.at)l=e.edge.b;else{var p=c(e),h=p.vertex,m=p.leftEdge,g=p.rightEdge;h.edges.push(m,g),l=h}if(0===t.at)v=t.edge.a;else if(1===t.at)v=t.edge.b;else{var y=c(t);h=y.vertex,m=y.leftEdge,g=y.rightEdge,h.edges.push(m,g),v=h,m.a.pathFind.artificialEdge=m,g.b.pathFind.artificialEdge=g}r||(r=function(e,t,r){return Math.abs(r.coords[0]-v.coords[0])+Math.abs(r.coords[1]-v.coords[1])});var b=function(e,t,r){var n=u++;a.clear(),e.pathFind.f=0,e.pathFind.g=0,e.pathFind.id=n,e.pathFind.parent=void 0,a.push(e,0);for(var o=a.pop();o&&o!==t;){for(var i=0,c=s(o);i<c.length;i++){var f=c[i],l=d(f,o);l.pathFind.id!==n&&(l.pathFind.g=o.pathFind.g+f.length,l.pathFind.f=l.pathFind.g+r(o,f,l),l.pathFind.parent=o,l.pathFind.id=n,a.push(l,l.pathFind.f))}o=a.pop()}if(o){for(var v=[],p=o;p;)v.push(p),p=p.pathFind.parent;return v.reverse(),v}}(l,v,r);if(b)return"artificial"===l.type&&(b[0]=d(e.edge,b[1])),"artificial"===v.type&&(v.edges[0].a.pathFind.artificialEdge=void 0,v.edges[1].b.pathFind.artificialEdge=void 0,b[b.length-1]=d(t.edge,b[b.length-2])),{fromAt:e.at,toAt:t.at,vertices:b}},t.breadthFirstTraversal=function(e,t,r){void 0===r&&(r=function(){return 0});var n=u++;a.clear();var o=new i.FlatQueue;e.pathFind.f=0,e.pathFind.g=0,e.pathFind.routeLength=0,e.pathFind.id=n,e.pathFind.parent=void 0,a.push(e,0);for(var c=a.pop();c&&t(c.pathFind.g,c.pathFind.routeLength);){for(var f=0,l=s(c);f<l.length;f++){var v=l[f],p=d(v,c);p.pathFind.id!==n&&(p.pathFind.routeLength=c.pathFind.routeLength+1,p.pathFind.g=c.pathFind.g+r(c,v,p),p.pathFind.f=-p.pathFind.g,p.pathFind.parent=c,p.pathFind.id=n,a.push(p,p.pathFind.routeLength),o.push(p,-p.pathFind.g))}c=a.pop()}if(c){for(var h=[],m=o.pop();m;)h.push(m),m=m.pathFind.parent;return h.reverse(),h}}},9294:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Point=void 0;var n=r(655),o=r(7723);r(4087);var i=r(1460),a=r(4603);r(7558);var u=function(e){function t(t){var r=e.call(this)||this;return r.forward=!0,r.lastUpdateTime=0,r.speed=t.speed,r.userData=t.userData,r.position={edge:t.position.edge,at:t.position.at},r.route={fromAt:r.position.at,toAt:r.position.at,vertices:[r.position.edge.a,r.position.edge.b]},r.edgeIndexInRoute=0,r}return n.__extends(t,e),t.prototype.moveTo=function(e){var t=a.pathfindFromMidway(this.position,e);t?this.setRoute(t):console.log("Not found route")},t.prototype.setRoute=function(e){var t=e.fromAt,r=e.vertices,n=e.toAt,o=i.findEdgeFromVertexToVertex(r[0],r[1]);o?(this.route.fromAt=t,this.route.vertices=r,this.route.toAt=n,this.edgeIndexInRoute=0,this.position.at=t,this.position.edge=o.edge,this.forward=o.forward):console.log("Не найдена кривая пути")},t.prototype.getRoute=function(){return this.route},t.prototype.getSpeed=function(){return this.speed},t.prototype.getCoords=function(){return i.getSegment(this.position.edge,this.position.at).coords},t.prototype.getPosition=function(){return this.position},t.prototype.isFinishedRoute=function(){return this.edgeIndexInRoute===this.route.vertices.length-2&&this.position.at===this.route.toAt},t.prototype.updateMoving=function(e){var t=this.position,r=this.speed*(e-this.lastUpdateTime);this.lastUpdateTime=e;var n=t.edge.length?r/t.edge.length:1,o=this.edgeIndexInRoute===this.route.vertices.length-2;if(!o||t.at!==this.route.toAt){var a,u;if(a=o?this.route.toAt:this.forward?1:0,this.forward?(t.at=t.at+n,u=a-t.at):(t.at=t.at-n,u=t.at-a),u<0){if(o)t.at=this.route.toAt;else{this.edgeIndexInRoute++;var c=i.findEdgeFromVertexToVertex(this.route.vertices[this.edgeIndexInRoute],this.route.vertices[this.edgeIndexInRoute+1]);c?(t.at=c.forward?0:1,t.edge=c.edge,this.forward=c.forward):console.log("Не найдена следующая кривая пути}")}this.isFinishedRoute()&&this.emit("routefinish")}this.emit("move")}},t}(o.EventEmitter);t.Point=u},6074:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Roads=void 0;var n=r(655),o=r(7134),i=r(8518),a=r(6009);r(4087);var u=r(1460),c=r(5502),s=r(9294),d={autoUpdate:!0},f=function(e){function t(t,r){void 0===r&&(r=d);var n=e.call(this)||this;return n.points=[],n.updateLoop=function(){requestAnimationFrame(n.updateLoop);var e=Date.now();n.update(e)},n.options=i.applyDefaults(r,d),n.graph=a.prepareGraph(t),n.vertexFinder=new c.VertexFinder(n.graph),n.options.autoUpdate&&requestAnimationFrame(n.updateLoop),n}return n.__extends(t,e),t.prototype.findNearestVertex=function(e,t){return void 0===t&&(t=1/0),this.vertexFinder.findNearest(e,t)},t.prototype.createPoint=function(e){var t=new s.Point(e);return this.points.push(t),t},t.prototype.removePoint=function(e){this.points=this.points.filter((function(t){return t!==e}))},t.prototype.getPositionCoords=function(e){return u.getSegment(e.edge,e.at).coords},t.prototype.update=function(e){this.points.forEach((function(t){return t.updateMoving(e)})),this.emit("update")},t}(o.EventEmitter);t.Roads=f},7558:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRouteGeometry=void 0,r(4087);var n=r(1460);function o(e,t,r){var o=[],i=n.getSegment(e,t),a=n.getSegment(e,r);if(o.push(i.coords),t<r)for(var u=i.segmentIndex+1;u<=a.segmentIndex;u++)o.push(e.geometry[u]);else for(u=i.segmentIndex;u>a.segmentIndex;u--)o.push(e.geometry[u]);return o.push(a.coords),o}t.getRouteGeometry=function(e){var t=e.fromAt,r=e.vertices,i=e.toAt,a=[],u=n.findEdgeFromVertexToVertex(r[0],r[1]),c=n.findEdgeFromVertexToVertex(r[r.length-2],r[r.length-1]);if(!u||!c)throw new Error("Не найдена кривая при отрисовки поиска пути");if(u.edge===c.edge)a.push.apply(a,o(u.edge,t,i));else{a.push.apply(a,o(u.edge,t,u.forward?1:0));for(var s=1;s<r.length-2;s++){var d=r[s],f=r[s+1],l=n.findEdgeFromVertexToVertex(d,f);if(!l)throw new Error("Не найдена кривая при отрисовки поиска пути");if(l.forward)for(var v=0;v<l.edge.geometry.length-1;v++)a.push(l.edge.geometry[v]);else for(v=l.edge.geometry.length-1;v>0;v--)a.push(l.edge.geometry[v])}a.push.apply(a,o(c.edge,c.forward?0:1,i))}return a}},655:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__extends:()=>o,__assign:()=>i,__rest:()=>a,__decorate:()=>u,__param:()=>c,__metadata:()=>s,__awaiter:()=>d,__generator:()=>f,__createBinding:()=>l,__exportStar:()=>v,__values:()=>p,__read:()=>h,__spread:()=>m,__spreadArrays:()=>g,__spreadArray:()=>y,__await:()=>b,__asyncGenerator:()=>_,__asyncDelegator:()=>P,__asyncValues:()=>O,__makeTemplateObject:()=>M,__importStar:()=>x,__importDefault:()=>w,__classPrivateFieldGet:()=>E,__classPrivateFieldSet:()=>F});var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function d(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function f(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var l=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function v(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||l(t,e,r)}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function y(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||t)}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function _(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof b?Promise.resolve(r.value.v).then(c,s):d(i[0][2],r)}catch(e){d(i[0][3],e)}var r}function c(e){u("next",e)}function s(e){u("throw",e)}function d(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function P(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){!function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}(n,o,(t=e[r](t)).done,t.value)}))}}}function M(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var j=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function x(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&l(t,e,r);return j(t,e),t}function w(e){return e&&e.__esModule?e:{default:e}}function E(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function F(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=r(7723),t=r(4432),n=[82.92494,55.0294],o=new mapgl.Map("map",{key:"042b5b75-f847-4f2a-b695-b5f58adc9dfd",center:n,zoom:14});function i(){return[n[0]+.06*(Math.random()-.5),n[1]+.03*(Math.random()-.5)]}window.addEventListener("resize",(function(){return o.invalidateSize()})),fetch("./data.json").then((function(e){return e.json()})).then((function(r){for(var n=new t.Roads(r),a=[],u=function(r){var u=n.findNearestVertex(e.mapPointFromLngLat(i()));if(u){var c=n.createPoint({position:u,speed:50}),s=function(){var t=n.findNearestVertex(e.mapPointFromLngLat(i()));t&&c.moveTo(t)};c.on("routefinish",s),s();var d,f=new mapgl.Marker(o,{coordinates:e.mapPointToLngLat(c.getCoords()),icon:"./icon.svg",size:[16,16],label:{text:""+r,offset:[0,0],fontSize:12},zIndex:1});c.on("move",(function(){var r=e.mapPointToLngLat(c.getCoords());f.setCoordinates(r),d&&d.destroy(),d=new mapgl.Polyline(o,{coordinates:t.getRouteGeometry(c.getRoute()).map((function(t){return e.mapPointToLngLat(t)})),color:"#ff000077",width:3,zIndex:0})})),a.push({point:c,marker:f})}},c=0;c<5;c++)u(c)}))})()})();